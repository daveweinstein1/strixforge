<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Strix Halo Setup</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #1b2636;
            color: white;
            padding: 20px;
        }

        .card {
            background: #243246;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #364863;
        }

        h2 {
            border-bottom: 2px solid #ff007c;
            padding-bottom: 10px;
        }

        button {
            background: #ff007c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        button:hover {
            background: #d40067;
        }

        pre {
            background: #111;
            padding: 10px;
            overflow-x: auto;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }

        .status-item {
            background: #333;
            padding: 10px;
            border-radius: 4px;
        }

        .label {
            color: #888;
            font-size: 0.8em;
        }

        .value {
            font-weight: bold;
            color: #fff;
        }
    </style>
</head>

<body>
    <h1>Strix Halo Installer (Alpha)</h1>

    <div class="card">
        <h2>System Status</h2>
        <div id="status" class="status-grid">
            <div class="status-item">Loading system info...</div>
        </div>
        <br>
        <button onclick="refreshStatus()">Refresh Status</button>
    </div>

    <div class="card">
        <h2>Marketplace</h2>
        <button onclick="fetchMarketplace()">Fetch Images</button>
        <div id="marketplace"></div>
    </div>

    <script>
        // Check if running in Wails context
        if (!window.go) {
            document.getElementById('status').innerHTML = '<div class="status-item" style="color:red">Error: Not running in Wails context</div>';
        }

        function refreshStatus() {
            if (window.go && window.go.main && window.go.main.App) {
                window.go.main.App.GetSystemStatus().then(status => {
                    let html = '';
                    for (const [key, value] of Object.entries(status)) {
                        html += `<div class="status-item"><div class="label">${key.toUpperCase()}</div><div class="value">${value}</div></div>`;
                    }
                    document.getElementById('status').innerHTML = html;
                }).catch(err => {
                    document.getElementById('status').innerHTML = 'Error: ' + err;
                });
            }
        }

        function fetchMarketplace() {
            if (window.go && window.go.main && window.go.main.App) {
                document.getElementById('marketplace').innerHTML = 'Loading...';
                window.go.main.App.FetchMarketplaceImages().then(images => {
                    let html = '<ul>';
                    images.forEach(img => {
                        html += `<li><strong>${img.name}</strong> (${img.source}): ${img.url}</li>`;
                    });
                    html += '</ul>';
                    document.getElementById('marketplace').innerHTML = html;
                });
            }
        }

        // Initial load
        setTimeout(refreshStatus, 500);
    </script>
</body>

</html>